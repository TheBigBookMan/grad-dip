- Web application is app stored on remote server delivered through internet into a browser interface. the servers attact attackers
- secure web app needs protect backend database, server application, network and app itself
- security requirements align with general security goals includeing:
	- CIA triad
	- IAAA (identification, authentication, authorisation and Accounting)
	- non-repudiation
- **Web Server**-
	- 2 parts
		- **Web Client**- 
			- generally browsers and other related tools that let users send requests to web server
		- **Web Server**-
			- based on request (if valid) fetches related resources from database and sends back the data to client as response to initial request
	- Resources can be two types
		- **Static**- resources consist of information that doesnt change frequently- html, js
		- **Dynamic**- information that changes frequently, web server builds part of the response on the fly using latest information and sends to the web client- json built on the fly with business logic
	- ![[Pasted image 20250521101004.png]]
- **Hypertest Transfer Protocol (HHTP)**-
	- most web clients with GUI communicate over web server using HTTP without using GUI
	- it is a request-response protocol used to transfer resources between client and server
- **What is Risk**-
	- the intersection of a threat, a weakness and an asset- Risk = Likelihood X Impact
	- attacker can use different ways to access resources or create disruption. each path is called an **attack vector**
	- below shows an attack vector
		- each path represents a risk that may or may not cause serious damage
		- sometimes identifying these paths is trvial, sometimes extremely dofficult
		- impact could be minor or catastrophic for business
		- identifying risk can help business implement proper controls against attaks
		- projects such as Open Web Application Security Project (OWASP) help us understand and learn about common risks related to web apps
	- ![[Pasted image 20250521140036.png]]

## Open Worldwide Application Security Project (OWASP)
- identifies the 'top 10' most serious risks for a broad array of organisations. each risk there is generic information about the likelihood and technical impact is provided using a risk rating framework
- framework uses these factors to assess and rate security risks
	- **Exploitability**- refers to how easily or difficult an attacker can exploit the vulnerability
	- **Weakness Prevalence**- indicates how common a specific vulnerability is across applications
	- **Weakness Detectability**- measures how easily the vulnerability can be detected during the development or testing phases
	- **Technical Impact**- assesses the potential damage or consequences for the system
	- **Business Impact**- reflects the broader consequences for the organisation, such as financial losses or reputational damage
	- ![[Pasted image 20250522084220.png]]
- The top 10 represents a broad consensus about most critical security risks to web apps
- **Key updates in recent OWASP top 10 application security risks**
	- ![[Pasted image 20250522090405.png]]
- **2021s top 10 risks in terms of current web application industry, common web vulnerabilities, detection and prevention**
	- **Broken Access Control**- when access control mechanisms fail, attackers can exploit these flaws to access unauthorised data and systems. UNderstanding how to properly secure access points is crucial
		- **Description**-
			- enforces policy so users cannot act outside of their intended permissions
			- users have a limited scope of access based on particular roles
		- **Vulnerabilities**-
			- violation of principle of least privilege or deny by default, where access should only be granted for particular capabilities, roles, or users but is available to anyone
			- bypassing access control checks by modifying URL- parameter tampering or force browsing- internal application state, or HTML page, or by using an attack tool modifying API requests
			- permitting viewing or editing someone elses account, by providing its unique identifier- insecure direct object references (IDOR)
			- Accessing API with missing access controls for POST, PUT, DELETE
			- Elevation of privilege. Acting as a user without being logged in or acting as an admin when logged in as a user
			- Metadata manipulation, such as replaying or tampering with a JSON Web Token (JWT) access control token, or a cookie or hidden field manipulated to elevate privileges or abusing JWT invalidation
			- CORS misconfiguration allows API access from unauthorised/untrusted origins
			- Force browser to authenticated pages as an unathenticated user or to privileged pages as a standard user
		- **Detections**-
			- review logs for unauth access
			- penetration testing for role boundary issues
			- automated scanners for access control gaps
		- **Preventions**- access control is only effective in trusted server-side code or server-less API, where attacker cannot modify the access control check or metadata
			- Except for public resources, deny by default
			- implement access control mechanisms once and re-use them throughout the application, including minimising Cross-Origin Resource Sharing (CORS) usage
			- model access controls should enforce record ownership rather than accepting that the user can create, read, update or delete any record
			- unique application business limit requirements should be enforced by domain models
			- disable web server directory listing and ensure file metadata (eg git) and backup files are not present within web roots
			- log access control failures, alert admins when appropriate (eg repeated failures)
			- rate limit API and controller access to minimise the harm from automated attack tooling
			- stateful session identifiers should be invalidated on the server after logout. stateless JWT tokens should rather be short lived so that the window of opportunity for an attacker is minimsed. for longer lived JWTs its highly recommended to follow the OAuth standards to revoke access
			- implement strict Role Based Access Control (RBAC)
			- developers and QA staff should include functional access control unit and integration tests
		- **Threat Agents/Attack Vectors**-
			- attacker modifies request parameter to send whatever account information they want, if not correctly verified the attacker can access any users account etc
			- attacker forces browses to target URLs that should require auth but dont, gaining access
		- **Impacts**-
			-  failures lead to unauthorised information disclosure, modification, or destruction of all data 
			- performing a business function outside of the users limit
	- **Crytpographic Failues**- this risk highlights the importance of securing sensitive data through robust encryption methods. Weak encryption or improper handling of cryptographic keys can lead to data breaches
		- **Description**-
			- important to identify the protection needs for different types of data in transit and rest, eg passwords, credit cards etc require extra protection- have government/universal regulations
			- weak or incorrectly implemented cryptography
		- **Vulnerabilities**-
			- data transmitted using clear text (non secure protocols like HTTP, SMTP, FTP)
			- allowing too much external traffic
			- verify all inernal traffic eg load balancers, web servers or back end systems
			- using old or weak cryptographic algorithms or protocls used either by default or in older code
			- improper key management or rotiation of keys not there
			- crypto keys checked into source code repositories
			- encryption might not be enfored correctly, eg HTTP security directives or headers missing
			- is the received server certificate and the trust chain propery validated
			- is an insecure mode of operation such as ECB in use, is encryption used when authenticated encryption is more appropriate
			- are passwwords being used as cryptographic keys in absence of a password base key derivation function
			- is randomness used for cryptographic purposes that was not designed to meet cryptographic requiremenets
			- deprecated hash functions such as MD5/SHA1 in use or non-cryoptographic hash functions used when cryptographic hash functions are needed
			- deprecated cryptographic padding methods such as PKCS number 1 v1.5 in use
			- are cryptographic error messages or side channel information exploitable eg in the form of padding oracle attacks
		- **Detections**-
			- static code analysis for cryptography misuse
			- TLS scanning
			- manual inspection for key management practices
		- **Preventions**-
			- classify data processed, stored or transmitted by application. identify which data is sensitive accotding to privacy laws and requirements
			- dont store sensitive data unnecessarily, discard as soon as poassible or use PCI DSS compliant tokenisation or even trauncation, data that is not retained cannot be stolen
			- ensure ecrypt all sensitive data at rest
			- ensure up-to-date and strong standard algorithms, protocls, and keys are in place- use proper key management
			- encrypto all data in transit with secure protoclls such as TLS with forward secrecy (FS) ciphers, cipher prioritisation by the server and secure parameters. enforce encryption using directives like HTTP Strict Transport Security (HSTS)
			- disable caching for response that contain sensitive data
			- apply required security controls as per the data classificaiton
			- do not use legacy protocols such as FTP, SMTP and HTTP for transporting sensitive data
			- store passwords using strong adaptve and salted hashing functions with a work factor (delay factor) such as Argon2, scrypt, bcrypt and PBKDF2
			- initialisation vectors must be chosen appropriate for the mode of operation, many modes this means using a cryptographically secure pseudo random number generator. 
			- always use authenticated encryption instead of just encryption
			- keys should be generated cryptographically randomly and stored in memeory as byte arrays. f password is used, then must be converted to a key via an appropriate password base key deriviation function
			- ensure that cryptographic randomness is used where appropriate and that is has not been seeded in predictable way or with low entropy, most modern APIs do not require developer to seed 
			- avoid deprecated cryptographic functions and padding schemes
			- verify independally the effectiveness of config and settings
		- **Threat Agents/Attack Vectors**-
			- man in the midde attacks on insecure connections
			- data breach via exposed plain text
			- sql injection from hacker revealing information with poor code practices
			- non enforcing TLS good practices like using HTTPS
			- poor password and encryption of data can leave easy decrpytion of passwords
		- **Impacts**-
			- regulatory penalties for bad data storage
			- loss of confidentiality and integrity (CIA)
			- reputation damage for non secure private data
	- **Injection**- One of the most common and dangerous risks is when attackers send malicious code through input fields to exploit vulnerabilities in an application
		- **Description**-
			- untrusted data is interpreted as code or comands and leading to arbitrary execution of code
			- can be malicious intent by actors or accidental input
			- more common injections are SQL, NoSQL, OS Command, ORM, LDAP, Expressive Langauge, Object Graph Navigation Library injections
				- concept common among them all
			- 
		- **Vulnerabilities**-
			- user-supplied dat ais not validated, filtered or sanitised by the application
			- dynamic queries or non-parameterised calls without context-aware excaping are used directly in the interpretar
			- hostile data is used within object-relational mapping (ORM) search parameters to extract additional, sensitive records
			- hostile data is directly used or concatenated. the SQL or command contains the structure and malicious data in dynamic queries, commands, or stored procedures
		- **Detections**-
			- source code review is best method detecing if vulnerable to injection
			- automated testing of all parameters, headers, URL, cookies, JSON, SOAP and XML data inputs strongly encouraged
			- organisations can inlcude status (SAST), dynamic (DAST) and interactive (IAST) application security testing tools into the CI/CD pipeline to identify introduced injection flaws before prod deployment
		- **Preventions**-
			- Keeping data seaparate from commands and queries
			- using a safe API which avoids using the interpreter entirely, provides a parameterised interface or migrates to ORM Tools
			- use positive server-side input validation- not a complete defense as many apps require special charracters, such as text ares or API for mobile apps
			- any residual dynamic queries, escape special characters using the specific escape syntax for that interpreter 
			- SQL structures such as table names, column names and so on cannot be escaped and therefore any user -supplied structure names are dangerous- common issue in report-writing software
			- use LIMIT and other SQL controls within queeries to prevent mass discolusre of records in case of SQL injection
		- **Threat Agents/Attack Vectors**-
			- malicious form input
			- query parameters or cookies containing injected code
		- **Impacts**-
			- database exfiltration or deletion
			- system compromise
			- remote code execution
	- **Insecure Design**- ensuring security is built into the design of applications from the ground up, preventing weaknesses that could be exploited later
		- **Description**-
		- **Vulnerabilities**-
		- **Detections**-
		- **Preventions**-
		- **Threat Agents/Attack Vectors**-
		- **Impacts**-
	- **Security Misconfiguration**- incorrectly configured settings can leave applications open to attack. Regular updates and proper configuration management are essential
		- **Description**-
		- **Vulnerabilities**-
		- **Detections**-
		- **Preventions**-
		- **Threat Agents/Attack Vectors**-
		- **Impacts**-
	- **Vulnerable and Outdated Components**- using outdated software components increases the risk of known vulnerabilities being exploited. Its critical to stay up-to-date
		- **Description**-
		- **Vulnerabilities**-
		- **Detections**-
		- **Preventions**-
		- **Threat Agents/Attack Vectors**-
		- **Impacts**-
	- **Identification and Authentication Failures**- weak authentication mechanisms allow attackers to bypass identity checks, gaining access to systems without proper authorisation
		- **Description**-
		- **Vulnerabilities**-
		- **Detections**-
		- **Preventions**-
		- **Threat Agents/Attack Vectors**-
		- **Impacts**-
	- **Software and Data Integrity Failures**- trusting unverified code or data sources can introduce malicious software into your systems
		- **Description**-
		- **Vulnerabilities**-
		- **Detections**-
		- **Preventions**-
		- **Threat Agents/Attack Vectors**-
		- **Impacts**-
	- **Security Logging and Monitoring Failures**- without proper monitoring and logging, breaches may go undetected for long periods, increasing damage
		- **Description**-
		- **Vulnerabilities**-
		- **Detections**-
		- **Preventions**-
		- **Threat Agents/Attack Vectors**-
		- **Impacts**-
	- **Server-side Request Forgery (SSRF)**- SSRF occurs when an attacker tricks a server into accessing unintended locations, potentially exposing sensitive data
		- **Description**-
		- **Vulnerabilities**-
		- **Detections**-
		- **Preventions**-
		- **Threat Agents/Attack Vectors**-
		- **Impacts**-